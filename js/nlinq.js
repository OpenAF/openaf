/*v:0.1.6;b:Nuno Aguiar;Copyright 2025 Nuno Aguiar;*/
var nLinq_USE_CASE=!1,nLinq=function(h,l){$$(h).isMap()&&(l=_$(l,"aKey").isString().default("_key"),h=Object.keys(h).map(a=>{$$(h[a]).isMap()&&(h[a][l]=a);return h[a]}));var f=h,n="",e=nLinq_USE_CASE,g=!1,p=!1,t=0,y=0,C=!1,w=[],D=0,H=function(a,b){if(null===a||void 0===a||null===b||void 0===b)return a===b;if(a.constructor!==b.constructor)return!1;if(a instanceof Function||a instanceof RegExp)return a===b;if(a===b||a.valueOf()===b.valueOf())return!0;if(Array.isArray(a)&&a.length!==b.length||a instanceof
    Date||!(a instanceof Object)||!(b instanceof Object))return!1;var d=Object.keys(a),k=Object.keys(b);if(d.length!=k.length)return!1;for(var m in a)if(d=a[m],$$(b[m]).isUnDef()||!H(d,b[m]))return!1;return!0},J=function(a,b,d){_$(a).isArray().$_();var k,m=!1;for(k=0;k<a.length&&!m;k++){var r=$$(d).isFunction()?d(a[k]):a[k];H(b,r)&&(m=!0)}return m?k-1:-1},A=function(a){if(!$$(a).isMap())return a;var b={};Object.keys(a).sort().forEach(d=>{b[d]=$$(a[d]).isMap()?A(a[d]):a[d]});return b},K=function(a,b){var d=
    b.map(k=>JSON.stringify(A(k),void 0,""));return a.filter(k=>0>d.indexOf(JSON.stringify(A(k),void 0,"")))},L=function(a,b){var d=b.map(k=>JSON.stringify(A(k),void 0,""));return a.filter(k=>0<=d.indexOf(JSON.stringify(A(k),void 0,"")))},M=function(a,b){var d=a.map(k=>JSON.stringify(A(k),void 0,""));return a.concat(b.filter(k=>0>d.indexOf(JSON.stringify(A(k),void 0,""))))},N=function(a,b){return a.map(d=>b.map(k=>isMap(k)?merge(d,k):[d,k])).reduce((d,k)=>d.concat(k))},u=(a,b,d)=>{$$(a).isFunction()&&
    (a=a());$$(a).isArray()||(a=[a]);if(!$$(a).isUnDef()){if(0<D)if(d)for(d=0;d<D;d++)n+=")";else return a;if(0==n.length){if(C)return[];0!=y&&(a=a.slice(y));return 0!=t?a.slice(0>t?t:0,0<t?t:void 0):a}n=n.replace(/;/g," ");var k=$$(b).isFunction()?b:new Function("r","whereFn","return $$(r).isDef() ? ("+n+") : void 0");f=0!=t?C?a.filter(m=>!k(m,w)).slice(0>t?t:0,0<t?t:void 0):a.filter(m=>k(m,w)).slice(0>t?t:0,0<t?t:void 0):C?a.filter(m=>!k(m,w)):a.filter(m=>k(m,w));0!=y&&(f=f.slice(y));return f}},O=a=>
    {if($$(a).isString()&&a.replace(/^[^a-zA-Z_$]|[^\w\[\]\.$]/g,"")==a)return a;if($$(a).isDef())throw"'"+a+"' is not a valid key.";},F=a=>{$$(a).isNumber()||$$(a).isBoolean()||($$(a).isString()&&(a=e?a:a.toLowerCase()),a=JSON.stringify(a,void 0,""));return a},P=a=>{var b=(k,m,r)=>{var v=Object.keys(k);_$(m,"aFunc").isFunction().$_();r=_$(r).isString().default("");for(var x in v)$$(k[v[x]]).isMap()||$$(k[v[x]]).isArray()?b(k[v[x]],m,(""==r?"":r+".")+v[x]):m(v[x],k[v[x]],r,k)},d={};b(a,(k,m,r,v)=>{d[r+
    (""==r?"":".")+k]=m});return d},q=(a,b,d,k,m,r)=>{if($$(r).isUnDef()&&$$(a).isMap()){var v=P(a);Object.keys(v).forEach(z=>{q(z,v[z],d,k)})}else{var x=!0;if(m){m=$$(r).isDef();var B=b;b=F(m?b:a);r=F(m?r:B)}else{m=$$(b).isDef();b=F(m?b:a);try{a=m?O(a):void 0}catch(z){if(0<String(z).indexOf("is not a valid key"))x=!1;else throw z;}}0<=d.indexOf("{ki}")&&(d=d.replace(/{ki}/g,$$(b).isString()&&!e?".toLowerCase()":""));0<=d.indexOf("{ski}")&&(d=d.replace(/{ski}/g,$$(b).isString()&&!e?"String(":""));0<=
    d.indexOf("{eki}")&&(d=d.replace(/{eki}/g,$$(b).isString()&&!e?").toLowerCase()":""));d=m?d.replace(/{k}/g,x?"r."+a:"$$$$(r).get("+JSON.stringify(a)+")"):d.replace(/{k}/g,"r");$$(b).isString()&&(b=b.replace(/\$/g,"$$$"));$$(r).isDef()?($$(r).isString()&&(r=r.replace(/\$/g,"$$$")),r=F(r),d=d.replace(/{v}/g,b).replace(/{v2}/g,r)):d=d.replace(/{v}/g,b);E(d,k)}},E=(a,b)=>{b=_$(b).default(g);0<n.trim().length&&!n.trim().endsWith("(")&&(n=b?"("+n+") || ":n+" && ");n+="("+a+")"},c={_setState:a=>{_$(a,"map").isMap().$_();
    n=a.where;e=a.useCase;g=a.useOr;p=a.useNot;t=a.alimit;y=a.askip;C=a.negative;w=a.whereFn;return c},_getState:()=>({where:n,useCase:e,useOr:g,useNot:p,alimit:t,askip:y,negative:C,whereFn:w}),useCase:a=>{e=$$(a).isUnDef()||a?!0:!1;return c},ignoreCase:a=>{e=$$(a).isUnDef()||a?!1:!0;return c},limit:a=>{$$(a).isNumber()&&(t=a);return c},head:a=>{c.limit(a);return c},tail:a=>{$$(a).isNumber()&&(t=-a);return c},or:()=>{g=!0;return c},and:()=>{g=!1;return c},not:()=>{p=!0;return c},andNot:()=>{g=!1;p=!0;
    return c},orNot:()=>{p=g=!0;return c},setWhere:a=>{E(a,!1);return c},where:a=>{g?p?c.orNotWhere(a):c.orWhere(a):p?c.andNotWhere(a):c.andWhere(a);return c},orWhere:a=>{_$(a,"fn").isFunction().$_();w.push(a);E("whereFn["+(w.length-1)+"](r)",!0);return c},andWhere:a=>{_$(a,"fn").isFunction().$_();w.push(a);E("whereFn["+(w.length-1)+"](r)",!1);return c},notWhere:a=>{g?c.orNotWhere(a):c.andNotWhere(a);return c},andNotWhere:a=>{_$(a,"fn").isFunction().$_();w.push(a);E("!whereFn["+(w.length-1)+"](r)",!1);
    return c},orNotWhere:a=>{_$(a,"fn").isFunction().$_();w.push(a);E("!whereFn["+(w.length-1)+"](r)",!0);return c},begin:()=>{n+=(0<n.trim().length&&!n.trim().endsWith("(")?" && ":"")+"(";D++;return c},orBegin:()=>{n+=(0<n.trim().length&&!n.trim().endsWith("(")?" || ":"")+"(";D++;return c},andBegin:()=>c.begin(),end:()=>{0<D&&(n+=")",D--);return c},starts:(a,b)=>{g?p?c.orNotStarts(a,b):c.orStarts(a,b):p?c.andNotStarts(a,b):c.andStarts(a,b);return c},ends:(a,b)=>{g?p?c.orNotEnds(a,b):c.orEnds(a,b):p?
    c.andNotEnds(a,b):c.andEnds(a,b);return c},equals:(a,b)=>{g?p?c.orNotEquals(a,b):c.orEquals(a,b):p?c.andNotEquals(a,b):c.andEquals(a,b);return c},greater:(a,b)=>{g?p?c.orNotGreater(a,b):c.orGreater(a,b):p?c.andNotGreater(a,b):c.andGreater(a,b);return c},less:(a,b)=>{g?p?c.orNotLess(a,b):c.orLess(a,b):p?c.andNotLess(a,b):c.andLess(a,b);return c},greaterEquals:(a,b)=>{g?p?c.orNotGreaterEquals(a,b):c.orGreaterEquals(a,b):p?c.andNotGreaterEquals(a,b):c.andGreaterEquals(a,b);return c},lessEquals:(a,b)=>
    {g?p?c.orNotLessEquals(a,b):c.orLessEquals(a,b):p?c.andNotLessEquals(a,b):c.andLessEquals(a,b);return c},contains:(a,b)=>{g?p?c.orNotContains(a,b):c.orContains(a,b):p?c.andNotContains(a,b):c.andContains(a,b);return c},empty:(a,b)=>{g?p?c.orNotEmpty(a,b):c.orEmpty(a,b):p?c.andNotEmpty(a,b):c.andEmpty(a,b);return c},match:(a,b)=>{g?p?c.orNotMatch(a,b):c.orMatch(a,b):p?c.andNotMatch(a,b):c.andMatch(a,b);return c},type:(a,b)=>{g?p?c.orNotType(a,b):c.orType(a,b):p?c.andNotType(a,b):c.andType(a,b);return c},
    between:(a,b,d)=>{g?p?c.orNotBetween(a,b,d):c.orBetween(a,b,d):p?c.andNotBetween(a,b,d):c.andBetween(a,b,d);return c},betweenEquals:(a,b,d)=>{g?p?c.orNotBetweenEquals(a,b,d):c.orBetweenEquals(a,b,d):p?c.andNotBetweenEquals(a,b,d):c.andBetweenEquals(a,b,d);return c},is:a=>{g?p?c.orNotIs(a):c.orIs(a):p?c.andNotIs(a):c.andIs(a);return c},andStarts:(a,b)=>{q(a,b,"String({k}){ki}.startsWith({v})",!1);return c},andEnds:(a,b)=>{q(a,b,"String({k}){ki}.endsWith({v})",!1);return c},andEquals:(a,b)=>{q(a,b,
    "{ski}{k}{eki} == {v}",!1);return c},andGreater:(a,b)=>{q(a,b,"{ski}{k}{eki} > {v}",!1);return c},andLess:(a,b)=>{q(a,b,"{ski}{k}{eki} < {v}",!1);return c},andGreaterEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} >= {v}",!1);return c},andLessEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} <= {v}",!1);return c},andContains:(a,b)=>{q(a,b,"String({k}){ki}.indexOf({v}) >= 0",!1);return c},andEmpty:(a,b)=>{q(a,"","($$({k}).isUnDef() || String({k}){ki}.length == 0)",!1);return c},andMatch:(a,b)=>{q(a,b,"String({k}){ki}.match({v})",
    !1);return c},andType:(a,b)=>{q(a,b,"typeof {k} == {v}",!1);return c},andBetween:(a,b,d)=>{q(a,b,"({ski}{k}{eki} > {v} && {ski}{k}{eki} < {v2})",!1,!0,d);return c},andBetweenEquals:(a,b,d)=>{q(a,b,"({ski}{k}{eki} >= {v} && {ski}{k}{eki} <= {v2})",!1,!0,d);return c},andIs:a=>{q(a,"","{k} != null && {k}",!1);return c},notStarts:(a,b)=>{g?c.orNotStarts(a,b):c.andNotStarts(a,b);return c},notEnds:(a,b)=>{g?c.orNotEnds(a,b):c.andNotEnds(a,b);return c},notEquals:(a,b)=>{g?c.orNotEquals(a,b):c.andNotEquals(a,
    b);return c},notGreater:(a,b)=>{g?c.orNotGreater(a,b):c.andNotGreater(a,b);return c},notLess:(a,b)=>{g?c.orNotLess(a,b):c.andNotLess(a,b);return c},notGreaterEquals:(a,b)=>{g?c.orNotGreaterEquals(a,b):c.andNotGreaterEquals(a,b);return c},notLessEquals:(a,b)=>{g?c.orNotLessEquals(a,b):c.andNotLessEquals(a,b);return c},notContains:(a,b)=>{g?c.orNotContains(a,b):c.andNotContains(a,b);return c},notEmpty:(a,b)=>{g?c.orNotEmpty(a,b):c.andNotEmpty(a,b);return c},notMatch:(a,b)=>{g?c.orNotMatch(a,b):c.andNotMatch(a,
    b);return c},notType:(a,b)=>{g?c.orNotType(a,b):c.andNotType(a,b);return c},notBetween:(a,b,d)=>{g?c.orNotBetween(a,b,d):c.andNotBetween(a,b,d);return c},notBetweenEquals:(a,b,d)=>{g?c.orNotBetweenEquals(a,b,d):c.andNotBetweenEquals(a,b,d);return c},notIs:a=>{g?c.orNotIs(a):c.andNotIs(a);return c},andNotStarts:(a,b)=>{q(a,b,"!(String({k}){ki}.startsWith({v}))",!1);return c},andNotEnds:(a,b)=>{q(a,b,"!(String({k}){ki}.endsWith({v}))",!1);return c},andNotEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} != {v}",
    !1);return c},andNotGreater:(a,b)=>{q(a,b,"{ski}{k}{eki} <= {v}",!1);return c},andNotLess:(a,b)=>{q(a,b,"{ski}{k}{eki} >= {v}",!1);return c},andNotGreaterEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} < {v}",!1);return c},andNotLessEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} > {v}",!1);return c},andNotContains:(a,b)=>{q(a,b,"String({k}){ki}.indexOf({v}) < 0",!1);return c},andNotEmpty:(a,b)=>{q(a,"","($$({k}).isDef() && String({k}){ki}.length != 0)",!1);return c},andNotMatch:(a,b)=>{q(a,b,"!(String({k}){ki}.match({v}))",
    !1);return c},andNotType:(a,b)=>{q(a,b,"typeof {k} != {v}",!1);return c},andNotBetween:(a,b,d)=>{q(a,b,"({ski}{k}{eki} < {v} || {ski}{k}{eki} > {v2})",!1,!0,d);return c},andNotBetweenEquals:(a,b,d)=>{q(a,b,"({ski}{k}{eki} <= {v} || {ski}{k}{eki} >= {v2})",!1,!0,d);return c},andNotIs:a=>{q(a,"","{k} == null || !({k})",!1);return c},orStarts:(a,b)=>{q(a,b,"String({k}){ki}.startsWith({v})",!0);return c},orEnds:(a,b)=>{q(a,b,"String({k}){ki}.endsWith({v})",!0);return c},orEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} == {v}",
    !0);return c},orGreater:(a,b)=>{q(a,b,"{ski}{k}{eki} > {v}",!0);return c},orLess:(a,b)=>{q(a,b,"{ski}{k}{eki} < {v}",!0);return c},orGreaterEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} >= {v}",!0);return c},orLessEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} <= {v}",!0);return c},orContains:(a,b)=>{q(a,b,"String({k}){ki}.indexOf({v}) >= 0",!0);return c},orEmpty:(a,b)=>{q(a,"","($$({k}).isUnDef() || String({k}){ki}.length == 0)",!0);return c},orMatch:(a,b)=>{q(a,b,"String({k}){ki}.match({v})",!0);return c},orType:(a,
    b)=>{q(a,b,"typeof {k} == {v}",!0);return c},orBetween:(a,b,d)=>{q(a,b,"({ski}{k}{eki} > {v} && {ski}{k}{eki} < {v2})",!0,d);return c},orBetweenEquals:(a,b,d)=>{q(a,b,"({ski}{k}{eki} >= {v} && {ski}{k}{eki} <= {v2})",!0,d);return c},orIs:a=>{q(a,"","{k} != null && {k}",!0);return c},orNotStarts:(a,b)=>{q(a,b,"!(String({k}){ki}.startsWith({v}))",!0);return c},orNotEnds:(a,b)=>{q(a,b,"!(String({k}){ki}.endsWith({v}))",!0);return c},orNotEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} != {v}",!0);return c},orNotGreater:(a,
    b)=>{q(a,b,"{ski}{k}{eki} <= {v}",!0);return c},orNotLess:(a,b)=>{q(a,b,"{ski}{k}{eki} >= {v}",!0);return c},orNotGreaterEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} < {v}",!0);return c},orNotLessEquals:(a,b)=>{q(a,b,"{ski}{k}{eki} > {v}",!0);return c},orNotContains:(a,b)=>{q(a,b,"String({k}){ki}.indexOf({v}) < 0",!0);return c},orNotEmpty:(a,b)=>{q(a,"","($$({k}).isDef() && String({k}){ki}.length != 0)",!0);return c},orNotMatch:(a,b)=>{q(a,b,"!(String({k}){ki}.match({v}))",!0);return c},orNotType:(a,b)=>{q(a,
    b,"typeof {k} != {v}",!0);return c},orNotBetween:(a,b,d)=>{q(a,b,"({ski}{k}{eki} < {v} || {ski}{k}{eki} > {v2})",!1,!0,d);return c},orNotBetweenEquals:(a,b,d)=>{q(a,b,"({ski}{k}{eki} <= {v} || {ski}{k}{eki} >= {v2})",!1,!0,d);return c},orNotIs:a=>{q(a,"","{k} == null || !({k})",!0);return c},min:a=>{a=_$(a).isString().default(void 0);var b;c.select(d=>{var k=$$(a).isDef()?Number($$(d).get(a)):Number(d);null!=k&&$$(k).isNumber()&&($$(b).isUnDef()?b=d:($$(a).isDef()&&$$(b).get(a)>k&&(b=d),$$(a).isUnDef()&&
    b>k&&(b=d)))});return b},max:a=>{a=_$(a).isString().default(void 0);var b;c.select(d=>{var k=$$(a).isDef()?Number($$(d).get(a)):Number(d);null!=k&&$$(k).isNumber()&&($$(b).isUnDef()?b=d:($$(a).isDef()&&$$(b).get(a)<k&&(b=d),$$(a).isUnDef()&&b<k&&(b=d)))});return b},average:a=>{a=_$(a).isString().default(void 0);var b=0,d=0;c.select(k=>{k=$$(a).isDef()?Number($$(k).get(a)):Number(k);null!=k&&$$(k).isNumber()&&(d++,b+=k)});return 0<d?b/d:void 0},sum:a=>{a=_$(a).isString().default(void 0);var b=0;c.select(d=>
    {d=$$(a).isDef()?Number($$(d).get(a)):Number(d);null!=d&&$$(d).isNumber()&&(b+=d)});return b},distinct:a=>{a=_$(a).isString().default(void 0);var b=[];c.select(d=>{d=$$(a).isDef()?$$(d).get(a):d;0>b.indexOf(d)&&b.push(d)});return b},group:a=>{a=_$(a).isString().default(void 0);var b={};c.select(d=>{var k=$$(a).isDef()?$$(d).get(a):d;$$(k).isBoolean()&&(k=String(k));0>Object.keys(b).indexOf(k)?b[k]=[d]:b[k].push(d)});return b},groupBy:a=>{a=_$(a).isString().default("key");var b=a.split(",");a={};var d=
    (k,m,r)=>{Object.keys(k).forEach((v,x)=>{r[v]={};m+1<b.length&&d(nLinq(k[v]).group(b[m+1]),m+1,r[v]);b.length==m+1&&(r[v]=k[v])})};return 0<b.length?(d(c.group(b[0]),0,a),a):[]},minBy:(a,b,d,k)=>c.fnBy(a,m=>$$(nLinq(m).min(b)).get(b),_$(d).default("_min"),k),maxBy:(a,b,d,k)=>c.fnBy(a,m=>$$(nLinq(m).max(b)).get(b),_$(d).default("_max"),k),averageBy:(a,b,d,k)=>c.fnBy(a,m=>nLinq(m).average(b),_$(d).default("_avg"),k),sumBy:(a,b,d,k)=>c.fnBy(a,m=>nLinq(m).sum(b),_$(d).default("_sum"),k),countBy:(a,b,
    d)=>c.fnBy(a,k=>nLinq(k).count(),_$(b).default("_count"),d),fnBy:(a,b,d,k)=>{a=_$(a).isString().default("key");b=_$(b).isFunction().default(B=>B.length);d=_$(d).isString().default("_result");k=_$(k).isString().default(a);var m=a.split(","),r=k.split(","),v=[],x=(B,z,G)=>{Object.keys(B).forEach((I,Q)=>{G[r[z]]=I;z+1<m.length&&x(nLinq(B[I]).group(m[z+1]),z+1,G);m.length==z+1&&(G[d]=b(B[I]),v.push(clone(G)))})};return 0<m.length?(x(c.group(m[0]),0,{}),v):[]},at:a=>{_$(a,"index").isNumber().$_();f=u(f,
    __,!0);return f[Number(a)]},all:a=>{f=u(f,__,!0);return $$(f).isArray()?f.length==h.length:a},count:()=>{f=u(f,__,!0);return f.length},first:a=>{f=u(f,__,!0);return 0<f.length?f[0]:a},last:a=>{f=u(f,__,!0);return 0<f.length?f[f.length-1]:a},any:()=>{f=u(f,__,!0);return 0<f.length},none:()=>{f=u(f,__,!0);return 0==f.length},reverse:()=>{f=u(f,__,!0);return f.reverse()},each:a=>{_$(a,"each function").isFunction().$_();c.select(a);return c},intersect:a=>{_$(a,"intersect param").isArray().$_();f=u(f);
    f=L(f,a);return c},except:a=>{_$(a,"except param").isArray().$_();f=u(f);f=K(f,a);return c},union:a=>{_$(a,"union param").isArray().$_();f=u(f);f=M(f,a);return c},cartesian:a=>{_$(a,"cartesian param").isArray().$_();f=u(f);f=N(f,a);return c},attach:(a,b)=>{_$(a,"key").$_();_$(b,"value").$_();f=u(f);f=$$(b).isFunction()?f.map(d=>{$$(d).set(a,b(d));return d}):f.map(d=>{$$(d).set(a,b);return d});return c},attachBy:(a,b,d,k)=>{_$(a,"newkey").isString().$_();_$(b,"key").isString().$_();_$(d,"value").$_();
    _$(k,"class").$_();f=u(f);f=f.map(m=>{d==$$(m).get(b)&&$$(m).set(a,k);return m});return c},attachNotBy:(a,b,d,k)=>{_$(a,"newkey").isString().$_();_$(b,"key").isString().$_();_$(d,"value").$_();_$(k,"class").$_();f=u(f);f=f.map(m=>{d!=$$(m).get(b)&&$$(m).set(a,k);return m});return c},attachByEmpty:(a,b)=>{_$(a,"newkey").isString().$_();_$(b,"class").$_();f=u(f);f=f.map(d=>{(null==$$(d).get(a)||$$($$(d).get(a)).isUnDef())&&$$(d).set(a,b);return d});return c},detach:a=>{_$(a,"key").$_();f=u(f);f=f.map(b=>
    {$$(b).unset(a);return b});return c},toDate:a=>{_$(a,"key").$_();f=u(f);f.forEach(b=>{try{var d=$$(b).get(a);($$(d).isString()||$$(d).isNumber())&&$$(b).set(a,new Date(d))}catch(k){}});return c},filter:a=>{_$(a,"value").$_();f=u(f);f=f.filter(b=>{var d=!0;$$(a).isMap()&&$$(b).isMap()&&Object.keys(a).forEach(k=>{H(a[k],b[k])||(d=!1)});$$(b).isArray()&&0>J(b,a)&&(d=!1);$$(a).isFunction()&&!a(b)&&(d=!1);($$(a).isNumber()||$$(a).isString())&&($$(b).isNumber()||$$(b).isString())&&b!=a&&(d=!1);return d});
    return c},sort:function(){var a="";f=u(f);for(var b=0;b<arguments.length;b++){var d=arguments[b],k=!1;d.startsWith("-")&&(k=!0,d=d.substr(1,d.length-1));a=0<a.length?a+" || ":"return ";a=k?a+(' ($$(a).get("'+d+'") > $$(b).get("'+d+'") ? -1 : ($$(a).get("'+d+'") < $$(b).get("'+d+'") ? 1 : 0)) '):a+(' ($$(a).get("'+d+'") > $$(b).get("'+d+'") ? 1 : ($$(a).get("'+d+'") < $$(b).get("'+d+'") ? -1 : 0)) ')}f=f.sort(new Function("a","b",a));return c},assign:(a,b,d,k,m)=>{f=u(f);f.forEach(r=>{r[b]=nLinq(a).equals(k,
    $$(r).get(d)).first(m)});return c},join:(a,b,d,k)=>{f=u(f);f.forEach(m=>{m[b]=nLinq(a).equals(k,$$(m).get(d)).select()});return c},skip:a=>{_$(a).isNumber().$_();y=a;return c},skipWhile:a=>{_$(a,"skip function").isFunction().$_();c.notWhere(a);return c},takeWhile:a=>{_$(a,"take function").isFunction().$_();c.where(a);return c},take:a=>{_$(a).isNumber().$_();return c.limit(a)},skipTake:(a,b)=>{_$(a).isNumber().$_();return c.skip(a).take(b)},apply:a=>{a=_$(a,"aMap").isMap().default({});a.where=_$(a.where,
    "where").isArray().default([]);a.select=_$(a.select,"select").default(void 0);a.transform=_$(a.transform,"transform").isArray().default([]);a.selector=_$(a.selector,"selector").isMap().default(void 0);a.where.forEach(d=>{$$(d.cond).isString()&&(c=c[d.cond].apply(c,d.args))});a.transform.forEach(d=>{$$(d.func).isString()&&(c=c[d.func].apply(c,d.args))});var b;$$(a.select).isString()&&(b=c.tselect(new Function("elem","index","array",a.select)));$$(a.select).isMap()&&(b=c.select(a.select));$$(b).isUnDef()&&
    $$(a.selector).isMap()&&(b=$$(a.selector.func).isString()?$$({}).set(a.selector.func,c[a.selector.func].apply(c,a.selector.args)):b);$$(b).isUnDef()&&$$(a.select).isUnDef()&&(b=c.select());return b},select:a=>{f=u(f,__,!0);if($$(a).isUnDef())return f;if($$(a).isFunction())return f.map(a);if($$(a).isArray()){var b={};a.forEach(k=>{if($$(k).isString())if(0<k.indexOf(":")){var m=k.substring(0,k.indexOf(":"));k=k.substring(k.indexOf(":")+1);b[m]=k}else b[k]=k});return f.map(k=>{var m={};Object.keys(b).forEach(r=>
    $$(m).set(r,$$(k).get(b[r])));return m})}if($$(a).isMap()){var d=Object.keys(a);return f.map(k=>{var m={};d.forEach(r=>{$$($$(k).get(r)).isDef()?$$(m).set(r,$$(k).get(r)):$$(m).set(r,$$(a).get(r))});return m})}},mselect:(a,b,d)=>{a=c.select(a);b=_$(b,"aKey").isString().default("_key");d=_$(d,"dontRemove").isBoolean().default(!0);var k={},m;for(m in a){var r=a[m];if($$(b).isDef()&&$$(r[b]).isDef()){var v=r[b];k[v]=r;d||delete k[v][b]}else k["row"+m]=r}return k},define:a=>{f=c.select(a);return c},removed:a=>
    {C=!0;f=c.select(a);return c},stream:a=>{var b=0<t?t:1;a=c.streamFn(a);do a(),0<t&&b--;while($$(f).isDef()&&0<b)},streamFn:a=>()=>{var b=c.select(a);f=$$(h).isFunction()?h():h;return b},query:a=>{a=_$(a,"aMap").isMap().default({});a.where=_$(a.where,"where").isArray().default([]);a.select=_$(a.select,"select").default(void 0);a.transform=_$(a.transform,"transform").isArray().default([]);a.selector=_$(a.selector,"selector").isMap().default(void 0);a.where.forEach(d=>{$$(d.cond).isString()&&(c=c[d.cond].apply(c,
    d.args))});a.transform.forEach(d=>{$$(d.func).isString()&&(c=c[d.func].apply(c,d.args))});var b;$$(a.select).isString()&&(b=c.tselect(newFn("elem","index","array",a.select)));$$(a.select).isMap()&&(b=c.select(a.select));$$(b).isUnDef()&&$$(a.selector).isMap()&&(b=$$(a.selector.func).isString()?c[a.selector.func].apply(c,a.selector.args):b);$$(b).isUnDef()&&$$(a.select).isUnDef()&&(b=c.select());return b}};return c},$from=nLinq;"defined"!=typeof isJavaObject&&(isJavaObject=()=>!1);
    const $$=function(h){return{get:l=>{if($$(h).isObject()){l=l.replace(/\[(\w+)\]/g,".$1");l=l.replace(/^\./,"");l=l.split(".");for(var f=0,n=l.length;f<n;++f){var e=l[f];if(e in h)h=h[e];else return}return h}},getI:l=>{if($$(h).isObject()){l=l.replace(/\[(\w+)\]/g,".$1");l=l.replace(/^\./,"");l=l.split(".");for(var f=0,n=l.length;f<n;++f){var e=l[f];if($$(h).isMap()){var g={};e=String(e).toUpperCase();Object.keys(h).forEach(p=>g[p.toUpperCase()]=p);if(e in g)h=h[g[e]];else return}else if(e in h)h=
    h[e];else return}return h}},set:(l,f)=>{if($$(h).isObject()){var n=h;l=l.replace(/\[(\w+)\]/g,".$1");l=l.replace(/^\./,"");l=l.split(".");for(var e,g,p=0,t=l.length;p<t;++p){var y=l[p];e=h;g=y;y in h||(h[y]={});h=h[y]}e[g]=f;return n}},unset:l=>{if($$(h).isObject()){var f=h;l=l.replace(/\[(\w+)\]/g,".$1");l=l.replace(/^\./,"");l=l.split(".");for(var n,e,g=0,p=l.length;g<p;++g){var t=l[g];n=h;e=t;t in h||(h[t]={});h=h[t]}delete n[e];return f}},isDef:()=>isJavaObject(h)||"undefined"!=typeof h?!0:!1,
    isUnDef:()=>isJavaObject(h)||"undefined"!=typeof h?!1:!0,isJavaObject:()=>isJavaObjecta(h),isArray:()=>Array.isArray(h),isMap:()=>"[object Object]"==Object.prototype.toString.call(h),isObject:()=>{var l=typeof h;return"function"===l||"object"===l&&!!h},isFunction:()=>"function"==typeof h||!1,isString:()=>"string"==typeof h||!1,isNumber:()=>!isNaN(parseFloat(h))&&isFinite(h),isTNumber:()=>"number"==typeof h||!1,isBoolean:()=>"boolean"==typeof h||!1,isNull:()=>null==h||!1,isDate:()=>null!=h&&!isNaN(h)&&
    "undefined"!==typeof h.getDate,isRegExp:()=>h instanceof RegExp,isUUID:()=>h.match(/^\b[0-9a-f]{8}\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\b[0-9a-f]{12}\b$/)?!0:!1,isSchema:(l,f)=>{if("undefined"==typeof Ajv)if("undefined"!=typeof loadAjv)loadAjv();else throw"Ajv library not loaded.";ow.loadObj();return ow.obj.schemaValidate(l,h,f)}}},_$=function(h,l){l=$$(l).isDef()?l+" ":"";var f=$$(h).isDef()?!0:!1;const n={default:e=>f?h:e,$_:e=>{$$(e).isUnDef()&&(e=l+"not defined or assigned");if(!f)throw e;return h},
    isNumber:e=>{$$(e).isUnDef()&&(e=l+"is not a number");if(f&&!$$(h).isNumber())throw e;return n},toNumber:e=>{$$(e).isUnDef()&&(e=l+"can't be converted to number");if(f)try{h=Number(h)}catch(g){throw e;}return n},isTNumber:e=>{$$(e).isUnDef()&&(e=l+"is not a number type");if(f&&!$$(h).isTNumber())throw e;return n},isString:e=>{$$(e).isUnDef()&&(e=l+"is not a string");if(f&&!$$(h).isString())throw e;return n},toString:e=>{$$(e).isUnDef()&&(e=l+"can't be converted to string");if(f)try{h=String(h)}catch(g){throw e;
    }return n},isBoolean:e=>{$$(e).isUnDef()&&(e=l+"is not boolean");if(f&&"boolean"!==typeof h)throw e;return n},toBoolean:e=>{$$(e).isUnDef()&&(e=l+"can't be converted to a boolean");if(f)try{$$(h).isNumber()&&(h=!!h),$$(h).isString()&&(h="true"==h.trim().toLowerCase())}catch(g){throw e;}return n},isArray:e=>{$$(e).isUnDef()&&(e=l+"is not an array");if(f&&!$$(h).isArray())throw e;return n},toArray:e=>{$$(e).isUnDef()&&(e=l+"can't be converted to an array");if(f)try{h=String(h).split(",").map(g=>g.trim())}catch(g){throw e;
    }return n},isMap:e=>{$$(e).isUnDef()&&(e=l+"is not a map");if(f&&!$$(h).isMap())throw e;return n},toMap:e=>{$$(e).isUnDef()&&(e=l+"can't be converted to a map");if(f)try{var g=h;h=$$(global.jsonParse).isFunction()?global.jsonParse(g,!0):JSON.parse(g)}catch(p){throw e;}return n},isObject:e=>{$$(e).isUnDef()&&(e=l+"is not an object");if(f&&!$$(h).isObject())throw e;return n},isDate:e=>{$$(e).isUnDef()&&(e=l+"is not a date");if(f&&!$$(h).isDate())throw e;return n},toDate:e=>{$$(e).isUnDef()&&(e=l+"can't be converted to date");
    if(f)try{h=new Date(h)}catch(g){throw e;}return n},isRegExp:e=>{$$(e).isUnDef()&&(e=l+"is not a RegExp");if(f&&!$$(h).isRegExp())throw e;return n},isFunction:e=>{$$(e).isUnDef()&&(e=l+"is not a function");if(f&&!$$(h).isFunction())throw e;return n},isJavaObject:e=>{$$(e).isUnDef()&&(e=l+"is not a java object");if(f&&!isJavaObject(h))throw e;return n},isInstanceOf:(e,g)=>{$$(g).isUnDef()&&(g=l+"is not an instance of "+e);if(f&&!(h instanceof e))throw g;return n},isNotNull:e=>{$$(e).isUnDef()&&(e=l+
    "is null");if(f&&null==h)throw e;return n},isUUID:e=>{$$(e).isUnDef()&&(e=l+"is not an UUID");if(f&&(!$$(h).isString()||h.match(/^\b[0-9a-f]{8}\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\b[0-9a-f]{12}\b$/)))throw e;return n},isSchema:(e,g,p)=>{if("undefined"==typeof Ajv)if("undefined"!=typeof loadAjv)loadAjv();else throw"Ajv library not loaded.";ow.loadObj();try{ow.obj.schemaValidate(e,h,p)}catch(t){throw $$(g).isUnDef()&&(g=l+" "+String(t)),g;}return n},check:(e,g)=>{if(!$$(e).isFunction()&&!$$(e).isString())throw"please provide a function to check";
    e=$$(e).isFunction()?e(h):newFn("v","return "+e)(h);$$(g).isUnDef()&&(g=l+"is not ok");if(f&&!e)throw g;return n},expr:(e,g)=>{if(!$$(e).isString())throw"please provide an expression";e=af.eval(templify(e,{v:h}));$$(g).isUnDef()&&(g=l+"is not ok");if(f&&!e)throw g;return n},equals:(e,g)=>{$$(g).isUnDef()&&(g=l+"is equals to "+e);if(f&&h==e)throw g;return n},notEquals:(e,g)=>{$$(g).isUnDef()&&(g=l+"is not equals to "+e);if(f&&h!=e)throw g;return n},anyOf:(e,g)=>{if(!$$(e).isArray())throw"please provide an array of values";
    $$(g).isUnDef()&&(g=l+"has a value not in "+JSON.stringify(e));f&&$$(h).isArray()&&h.forEach(p=>{if(0>e.indexOf(p))throw g;});return n},oneOf:(e,g)=>{if(!$$(e).isArray())throw"please provide an array of values";$$(g).isUnDef()&&(g=l+"is not one of "+JSON.stringify(e));if(f&&!$$(h).isArray()&&0>e.indexOf(h))throw g;return n},between:(e,g,p)=>{$$(p).isUnDef()&&(p=l+"is not between "+e+" and "+g);if(f&&(h>=g||h<=e))throw p;},betweenEquals:(e,g,p)=>{$$(p).isUnDef()&&(p=l+"is not between "+e+" and "+g);
    if(f&&(h>g||h<e))throw p;},less:(e,g)=>{$$(g).isUnDef()&&(g=l+"is less than "+e);if(f&&h>=e)throw g;return n},lessEquals:(e,g)=>{$$(g).isUnDef()&&(g=l+"is less or equals than "+e);if(f&&h>e)throw g;return n},greater:(e,g)=>{$$(g).isUnDef()&&(g=l+"is greater than "+e);if(f&&h<=e)throw g;return n},greaterEquals:(e,g)=>{$$(g).isUnDef()&&(g=l+"is greater or equals than "+e);if(f&&h<e)throw g;return n},notEmpty:e=>{$$(e).isUnDef()&&(e=l+"is empty");if(f&&""==String(h))throw e;return n},empty:e=>{$$(e).isUnDef()&&
    (e=l+"is not empty");if(f&&""!=String(h))throw e;return n},contains:(e,g)=>{if(!$$(e).isString())throw"please provide a string to check if contains";$$(g).isUnDef()&&(g=l+"doesn't contain "+e);if(f&&0>String(h).indexOf(e))throw g;return n},notContains:(e,g)=>{if(!$$(e).isString())throw"please provide a string to check if not contains";$$(g).isUnDef()&&(g=l+"contains "+e);if(f&&0<=String(h).indexOf(e))throw g;return n},starts:(e,g)=>{if(!$$(e).isString())throw"please provide a string to check if it starts with";
    $$(g).isUnDef()&&(g=l+"doesn't start with '"+e+"'");if(f&&!h.startsWith(aValu))throw g;return n},ends:(e,g)=>{if(!$$(e).isString())throw"please provide a string to check if it ends with";$$(g).isUnDef()&&(g=l+"doesn't end with '"+e+"'");if(f&&!h.endsWith(e))throw g;return n},notStarts:(e,g)=>{if(!$$(e).isString())throw"please provide a string to check if it not starts with";$$(g).isUnDef()&&(g=l+"starts with '"+e+"'");if(f&&h.startsWith(aValu))throw g;return n},notEnds:(e,g)=>{if(!$$(e).isString())throw"please provide a string to check if it not ends with";
    $$(g).isUnDef()&&(g=l+"ends with '"+e+"'");if(f&&h.endsWith(e))throw g;return n},regexp:(e,g)=>{$$(g).isUnDef()&&(g=l+"doesn't match '"+e+"'");if(!(e instanceof RegExp))throw"is not a regular expression ("+e+")";if(f&&!e.test(h))throw g;return n},javaRegexp:(e,g,p)=>{if($$(e).isUnDef()||!$$(e).isString())throw"please provide a regular expression string";$$(p).isUnDef()&&(p=l+"doesn't match '"+e+"'");if(f&&!javaRegExp(h).test(e,g))throw p;return n}};return n};